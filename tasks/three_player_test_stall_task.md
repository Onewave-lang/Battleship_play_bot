# Задача: трипле-тест зависает на ходе бота

**Проблема**

В тестовом трёхстороннем матче для админов партия часто замирает на ходу бота «B»: чат сообщает, что следующий ход также за ботом, но выстрелов больше не происходит.

**Причина**

В `_auto_play_bots` координата выстрела выбирается только среди клеток, где у текущего бота нет собственных кораблей: `if match.history[r][c] == 0 and _cell_state(match.boards[current].grid[r][c]) != 1`. Когда бот перебрал все свободные клетки поля, в глобальной истории остаются только клетки с его собственными кораблями, и цикл выходит по `coord is None`.

**Последствия**

Матч остаётся в статусе `playing`, ход закрепляется за ботом и не передаётся другим участникам, поэтому партия блокируется.

**Что нужно сделать**

- Обновить выбор координаты в `_auto_play_bots`, чтобы боты могли стрелять по любым ещё не обстрелянным клеткам, независимо от содержимого их собственных досок.
- Убедиться, что при отсутствии допустимых координат матч корректно завершается (например, фиксацией победителя), а не зависает на боте.
- Добавить регрессионный тест для сценария, когда у бота остаются только клетки с собственными кораблями.
