–°–æ–±—Ä–∞—Ç—å –¥–≤—É—Ö–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π ¬´–ú–æ—Ä—Å–∫–æ–π –±–æ–π¬ª –Ω–∞ python‚Äëtelegram‚Äëbot v20+ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –≤–≤–æ–¥–æ–º —Ö–æ–¥–æ–≤ –∏ –≤—ã–≤–æ–¥–æ–º –ø–æ–ª–µ–π –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–º <pre>. –Ø –¥–∞—é –Ω–∏–∂–µ: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö, –ª–æ–≥–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏–π, –∫–ª—é—á–µ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–π —Å –∑–∞–ø—Ä–µ—Ç–æ–º —Å–æ–ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∞ ¬´—Ä–∞–Ω–∏–ª/—É–±–∏–ª¬ª, –∞–≤—Ç–æ–∫–æ–Ω—Ç—É—Ä –≤–æ–∫—Ä—É–≥ —É–±–∏—Ç–æ–≥–æ), –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ PTB, —Ç–∞–π–º–µ—Ä—ã, —à–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å–æ–≤–µ—Ç—ã –ø–æ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏.

1) –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–π
1.1 –ú–æ–¥–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

–ü—Ä–∏–≤–∞—Ç–Ω–∞—è –¥—É—ç–ª—å –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é:

–ò–≥—Ä–æ–∫ A ‚Üí /newgame ‚Üí –±–æ—Ç —Å–æ–∑–¥–∞—ë—Ç match_id –∏ –≤—ã—Å—ã–ª–∞–µ—Ç deep‚Äëlink: t.me/<bot>?start=inv_<match_id>.

–ò–≥—Ä–æ–∫ B –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ ‚Üí –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ –º–∞—Ç—á—É.

–ò–¥—É—Ç –¥–≤–µ —Ñ–∞–∑—ã: —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ ‚Üí –±–æ–π.

–í–µ—Å—å –≤–≤–æ–¥ ‚Äî —Ç–µ–∫—Å—Ç–æ–º: –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∫–æ—Ä–∞–±–ª–µ–π –∏ –≤—ã—Å—Ç—Ä–µ–ª–æ–≤ (–∫–Ω–æ–ø–∫–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ –¢–ó).

1.2 –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–æ–ª–µ–π

–¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç, HTML parse_mode, –≤—Å—è –¥–æ—Å–∫–∞ –≤ <pre>...</pre>.

–°–∏–º–≤–æ–ª—ã (–ø—Ä–æ—Å—Ç—ã–µ, –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–µ):
¬∑ ‚Äî –ø—É—Å—Ç–æ, x ‚Äî –º–∏–º–æ, ‚ñ† ‚Äî –ø–æ–ø–∞–¥–∞–Ω–∏–µ, ‚ñì ‚Äî –∫–ª–µ—Ç–∫–∞ —É–±–∏—Ç–æ–≥–æ –∫–æ—Ä–∞–±–ª—è, —Ü–∏—Ñ—Ä—ã/–±—É–∫–≤—ã ‚Äî –æ—Å–∏.

–í–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –Ω–∞ –≤—ã—Å—Ç—Ä–µ–ª—ã: —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ö–æ–¥–∞ –ø—Ä–æ–º–∞—Ö –ø–æ–º–µ—á–∞–µ–º –∫—Ä–∞—Å–Ω—ã–º –∫—Ä–µ—Å—Ç–∏–∫–æ–º, –ø–æ–ø–∞–¥–∞–Ω–∏–µ ‚Äî –∫—Ä–∞—Å–Ω—ã–º –∫–≤–∞–¥—Ä–∞—Ç–æ–º, –∞ –ø–∞–ª—É–±—ã —É–Ω–∏—á—Ç–æ–∂–µ–Ω–Ω–æ–≥–æ –∫–æ—Ä–∞–±–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ —Å–∏–º–≤–æ–ª üí£ –∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —Ö–æ–¥—É –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º x/‚ñ†/‚ñì.

–†–µ–Ω–¥–µ—Ä–∏–º –¥–≤–∞ –≤–∏–¥–∞ –ø–æ–ª–µ–π:

¬´–°–≤–æ–µ –ø–æ–ª–µ¬ª (–≤–∏–¥–Ω—ã –∫–æ—Ä–∞–±–ª–∏ –∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤—Ä–∞–≥–∞).

¬´–ü–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞¬ª (–≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –≤–∞—à–∏ –≤—ã—Å—Ç—Ä–µ–ª—ã: –º–∏–º–æ/–ø–æ–ø–∞–¥–∞–Ω–∏—è/—É–±–∏—Ç—ã–µ).

2) –§–æ—Ä–º–∞—Ç—ã –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
2.1 –†–∞–∑–º–µ—Ä—ã –∏ –æ—Å–∏

–†–∞–∑–º–µ—Ä: 10 √ó 10.

–û—Å—å X (–∫–æ–ª–æ–Ω–∫–∏, –∫–∏—Ä–∏–ª–ª–∏—Ü–∞): –∞ –± –≤ –≥ –¥ –µ –∂ –∑ –∏ –∫ (10 –±—É–∫–≤, –±–µ–∑ ¬´–π¬ª).

–û—Å—å Y (—Å—Ç—Ä–æ–∫–∏): 1‚Ä¶10.

–í–≤–æ–¥ –∫–ª–µ—Ç–∫–∏: –ø—Ä–∏–º–µ—Ä –≥7, –¥10, –¥–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ‚Äë/—Ä–∞—Å–∫–ª–∞–¥–æ—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (—Å–º. 4.1).

2.2 –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –º–∞—Ç—á–∞ (JSON-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)
{
  "match_id": "uuid",
  "status": "waiting|placing|playing|finished",
  "created_at": "2025-08-23T06:00:00Z",
  "players": {
    "A": {"user_id": 111, "chat_id": 111, "ready": false},
    "B": {"user_id": 222, "chat_id": 222, "ready": false}
  },
  "turn": "A|B",                 // —á–µ–π —Ö–æ–¥ –≤ —Ñ–∞–∑–µ –±–æ—è
  "boards": {
    "A": { "ships": [...], "grid": [[0..],..], "alive_cells": 20 },
    "B": { "ships": [...], "grid": [[0..],..], "alive_cells": 20 }
  },
  "shots": {
    "A": {"history": ["–≥7","–¥3",...], "last_result": "miss|hit|kill"},
    "B": {"history": [...], "last_result": "..."}
  },
  "messages": {                   // (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç–µ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ-¬´–¥–∞—à–±–æ—Ä–¥¬ª)
    "A": {"main_msg_id": 0},
    "B": {"main_msg_id": 0}
  }
}

–ü–æ–ª—è boards.*

grid: —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ 10√ó10. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–¥—ã:

0 ‚Äî –ø—É—Å—Ç–æ,

1 ‚Äî –∂–∏–≤–∞—è –ø–∞–ª—É–±–∞ –∫–æ—Ä–∞–±–ª—è,

2 ‚Äî –ø—Ä–æ–º–∞—Ö,

3 ‚Äî –ø–æ–ø–∞–¥–∞–Ω–∏–µ (—Ä–∞–Ω–µ–Ω),

4 ‚Äî —É–±–∏—Ç–∞—è –ø–∞–ª—É–±–∞,

5 ‚Äî ¬´–∑–∞–ø—Ä–µ—Ç–Ω–∞—è¬ª –≤–æ–∫—Ä—É–≥ —É–±–∏—Ç–æ–≥–æ (—Ç–æ—á–∫–∞, –∫—É–¥–∞ —Å—Ç—Ä–µ–ª—è—Ç—å –Ω–µ –Ω–∞–¥–æ).

ships: —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∞–±–ª–µ–π:
{"cells":[[r,c],...], "alive":true} ‚Äî –ø–∞–ª—É–±—ã –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã —è–≤–Ω—ã–º —Å–ø–∏—Å–∫–æ–º.

2.3 –§–ª–æ—Ç

1√ó4, 2√ó3, 3√ó2, 4√ó1 = 10 –∫–æ—Ä–∞–±–ª–µ–π, 20 –ø–∞–ª—É–±.

–í–µ—Ä—Ç–∏–∫–∞–ª—å/–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å, –º–∏–Ω–∏–º—É–º 1 –∫–ª–µ—Ç–∫–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –ø–æ –≤—Å–µ–º –≤–æ—Å—å–º–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º.

2.4 –•—Ä–∞–Ω–∏–ª–∏—â–µ

–ù–∞ —Å—Ç–∞—Ä—Ç: SQLite / TinyDB / JSON‚Äë—Ñ–∞–π–ª + file lock.

–í –ø—Ä–æ–¥–µ: PostgreSQL (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏) –∏–ª–∏ Redis (–∞—Ç–æ–º–∞—Ä–Ω—ã–µ –ª—É–∞‚Äë–æ–ø–µ—Ä–∞—Ü–∏–∏/–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏).

–ú–∏–Ω–∏–º—É–º CRUD:

create_match(a_user) ‚Üí match_id.

join_match(match_id, b_user) ‚Üí —Å—Ç–∞—Ç—É—Å placing.

save_board(user, ships) ‚Üí players.*.ready = true ‚Üí –∫–æ–≥–¥–∞ –æ–±–∞ ready ‚Üí status=playing, turn='A'.

apply_shot(attacker, cell) ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí –∏–∑–º–µ–Ω–µ–Ω–∏–µ grid, alive_cells ‚Üí turn (–ø–æ–≤—Ç–æ—Ä —Ö–æ–¥–∞ –ø—Ä–∏ hit/kill).

finish(winner).

3) –õ–æ–≥–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (state machine)
waiting  --(B join)-->  placing  --(A ready & B ready)-->  playing  --(all sunk)--> finished


waiting: –º–∞—Ç—á —Å–æ–∑–¥–∞–Ω, –∂–¥—ë—Ç –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞.

placing: –æ–±–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏ (–∏–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ) –≤–≤–æ–¥—è—Ç —Å–≤–æ–∏ –∫–æ—Ä–∞–±–ª–∏.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∫–Ω–æ–ø–∫–æ–π –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–º ¬´–∞–≤—Ç–æ¬ª).

playing:

–•–æ–¥–∏—Ç —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫; –µ—Å–ª–∏ miss ‚Üí —Ö–æ–¥ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ hit/kill ‚Üí —Ö–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è.

–ü—Ä–∏ kill: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞–µ–º –∫–æ–Ω—Ç—É—Ä –≤–æ–∫—Ä—É–≥ –∫–æ—Ä–∞–±–ª—è –∫–∞–∫ ¬´–∑–∞–ø—Ä–µ—Ç–Ω—ã–π¬ª (–∫–æ–¥ 5), –∏ –Ω–∞ –ø–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ —Ä–∏—Å—É–µ–º x –≤ —ç—Ç–∏—Ö –∫–ª–µ—Ç–∫–∞—Ö.

finished: –æ–±—ä—è–≤–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º ¬´—Ä–µ–≤–∞–Ω—à¬ª (—Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π match_id).

4) –ö–ª—é—á–µ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
4.1 –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥7 / –¥10

–†–∞–∑—Ä–µ—à–∞–µ–º:

–∫–∏—Ä–∏–ª–ª–∏—Ü—É (–∞..–∫ –±–µ–∑ –π),

–ª–∞—Ç–∏–Ω–∏—Ü—É‚Äë—Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): a,b,v,g,d,e,zh,z,i,k.

–†–µ–≥–µ–∫—Å –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞:
^[–∞–±–≤–≥–¥–µ–∂–∑–∏–∫]\s*(10|[1-9])$ (—Ä–µ–≥–∏—Å—Ç—Ä –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –ø—Ä–æ–±–µ–ª—ã –¥–æ–ø—É—Å–∫–∞–µ–º).

–ú–∞–ø–ø–∏–Ω–≥ –±—É–∫–≤‚Üí—Å—Ç—Ä–æ–∫–∞ (0‚Äëbased):
{'–∞':0,'–±':1,'–≤':2,'–≥':3,'–¥':4,'–µ':5,'–∂':6,'–∑':7,'–∏':8,'–∫':9}
(–ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –¥–æ–±–∞–≤—å—Ç–µ ¬´–π¬ª –∫–∞–∫ –∞–ª–∏–∞—Å –∫ –∏, –Ω–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –≤ –¢–ó –±—É–∫–≤ 10).

–ß–∏—Å–ª–æ‚Üí—Å—Ç–æ–ª–±–µ—Ü: int(n)-1, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0..9.

4.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ—Ä–∞–±–ª—è:

–ü–∞–ª—É–±—ã –≤ –æ–¥–Ω—É –ª–∏–Ω–∏—é: –ª–∏–±–æ –≤—Å–µ r –æ–¥–∏–Ω–∞–∫–æ–≤—ã, –ª–∏–±–æ –≤—Å–µ c –æ–¥–∏–Ω–∞–∫–æ–≤—ã.

–î–ª–∏–Ω–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–∏–ø–æ–º –∫–æ—Ä–∞–±–ª—è.

–ö–ª–µ—Ç–∫–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 0..9.

–ù–µ—Ç –∫–∞—Å–∞–Ω–∏–π —Å —É–∂–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∫–æ—Ä–∞–±–ª—è–º–∏: –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ 8 —Å–æ—Å–µ–¥–µ–π –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π –ø–∞–ª—É–±—ã –ø–ª—é—Å —Å–∞–º—É –ø–∞–ª—É–±—É ‚Äî –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ 1 –≤ grid.

–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

–ü—ã—Ç–∞–µ–º—Å—è —Å–ª—É—á–∞–π–Ω–æ —Å—Ç–∞–≤–∏—Ç—å –∫–∞–∂–¥—ã–π –∫–æ—Ä–∞–±–ª—å, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥—ë–º –≤–∞–ª–∏–¥–Ω—É—é –ø–æ–∑–∏—Ü–∏—é (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —á–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫, 1000 —Ö–≤–∞—Ç–∏—Ç).

–°—Ä–∞–∑—É –ø–æ–º–µ—á–∞–µ–º grid[r][c]=1 –¥–ª—è –ø–∞–ª—É–±.

4.3 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Å—Ç—Ä–µ–ª–∞

–í –º–∞—Ç—Ä–∏—Ü–µ –æ–±–æ—Ä–æ–Ω—è—é—â–µ–≥–æ—Å—è:

–ï—Å–ª–∏ 0 ‚Üí 2 (miss).

–ï—Å–ª–∏ 1 ‚Üí 3 (hit) –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ ¬´—É–±–∏—Ç –ª–∏ –∫–æ—Ä–∞–±–ª—å?¬ª.

–ù–∞—Ö–æ–¥–∏–º –∫–æ—Ä–∞–±–ª—å (–ª–∏–±–æ —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å –≤ ships, –ª–∏–±–æ –ø—Ä–æ–±–µ–≥–æ–º –ø–æ —Å–ø–∏—Å–∫—É –∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º –∫–ª–µ—Ç–∫–∏).

–ï—Å–ª–∏ –≤—Å–µ –ø–∞–ª—É–±—ã –∫–æ—Ä–∞–±–ª—è —Ç–µ–ø–µ—Ä—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ 3 –∏–ª–∏ 4 ‚Üí —ç—Ç–æ kill:

–ü–µ—Ä–µ–≤–æ–¥–∏–º –≤—Å–µ –µ–≥–æ –ø–∞–ª—É–±—ã 3‚Üí4.

–û–±–≤–æ–¥–∏–º –∫–æ–Ω—Ç—É—Ä: –≤—Å–µ 8‚Äë—Å–æ—Å–µ–¥–∏ –∫–∞–∂–¥–æ–π –ø–∞–ª—É–±—ã:

–ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∏ –Ω–µ 4, —Å—Ç–∞–≤–∏–º 5 (–∑–∞–ø—Ä–µ—Ç–Ω–∞—è/–º–∏–º–æ –¥–ª—è –ø–æ–ª–∞ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞).

–í–æ–∑–≤—Ä–∞—â–∞–µ–º miss|hit|kill.

–°—á—ë—Ç—á–∏–∫ alive_cells —É–º–µ–Ω—å—à–∞–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –ø–æ –ø–∞–ª—É–±–µ (–∏–∑ 1 –≤ 3).

4.4 ¬´–ü—Ä–∞–≤–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö–æ–¥–∞¬ª

–ï—Å–ª–∏ hit|kill ‚Üí —Ç–æ—Ç –∂–µ –∞—Ç–∞–∫—É—é—â–∏–π —Ö–æ–¥–∏—Ç —Å–Ω–æ–≤–∞.

–ï—Å–ª–∏ miss ‚Üí —Ö–æ–¥ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç.

4.5 –£—Å–ª–æ–≤–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏—è

–ï—Å–ª–∏ defender.alive_cells == 0 ‚Üí –ø–æ–±–µ–¥–∞ –∞—Ç–∞–∫—É—é—â–µ–≥–æ, status=finished.

5) –í—ã–≤–æ–¥ –ø–æ–ª—è (—Ä–µ–Ω–¥–µ—Ä)
5.1 –õ–µ–≥–µ–Ω–¥–∞ —Å–∏–º–≤–æ–ª–æ–≤

–ù–∞ —Å–≤–æ—ë–º –ø–æ–ª–µ: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ—Ä–∞–±–ª–∏:

1 ‚Üí ‚ñ† (–∏–ª–∏ #, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ ASCII),

2 ‚Üí x,

3 ‚Üí ‚ñ† (–ø–æ–ø–∞–¥–∞–Ω–∏–µ, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–º –∂–µ —Å–∏–º–≤–æ–ª–æ–º –∏–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, *),

4 ‚Üí ‚ñì,

5 ‚Üí ¬∑ (–ø—É—Å—Ç–æ/–∑–∞–ø—Ä–µ—Ç–Ω–∞—è ‚Äî –∏–≥—Ä–æ–∫—É –±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã).

–ù–∞ –ø–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ (–≤–∏–¥–∏–º–æ–µ –∞—Ç–∞–∫—É—é—â–µ–º—É):

–ù–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ –Ω–µ–æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–ª–µ—Ç–∫–∏: ¬∑.

2 ‚Üí x,

3 ‚Üí ‚ñ†,

4 ‚Üí ‚ñì,

5 ‚Üí x (—Ç–∞–∫ –∏–≥—Ä–æ–∫ –≤–∏–¥–∏—Ç, —á—Ç–æ —Ç—É–¥–∞ —Å—Ç—Ä–µ–ª—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ).

5.2 –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (HTML)

–û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤ Telegram —Å parse_mode='HTML':

<pre>    –∞ –± –≤ –≥ –¥ –µ –∂ –∑ –∏ –∫
1  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
2  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
3  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
4  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
5  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
6  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
7  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
8  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
9  | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑
10 | ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑ ¬∑</pre>


–í–∞–∂–Ω–æ: —ç–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ &, <, > –≤ –æ–±—ã—á–Ω–æ–º —Ç–µ–∫—Å—Ç–µ –≤–Ω–µ <pre>, –≤–Ω—É—Ç—Ä–∏ <pre> ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª—ã –¥–æ—Å–∫–∏.

6) UX‚Äë–ø–æ—Ç–æ–∫–∏ –∏ —Ç–µ–∫—Å—Ç—ã
6.1 /newgame (–ê —Å–æ–∑–¥–∞—ë—Ç –º–∞—Ç—á)

–û—Ç–≤–µ—Ç –ê:

¬´–ú–∞—Ç—á —Å–æ–∑–¥–∞–Ω. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞: t.me/<bot>?start=inv_<match_id>¬ª.

¬´–î–∞–ª–µ–µ ‚Äî —Ñ–∞–∑–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è. –í—ã—à–ª–∏—Ç–µ –∞–≤—Ç–æ –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∞–±–ª–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
4: –∞1-–∞4; 3: –≥7-–µ7; 3: –∏10-–∫10; 2: ...; 2: ...; 2: ...; 1: ...; 1: ...; 1: ...; 1: ...
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ/–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –æ—Ç—Ä–µ–∑–∫–∏.¬ª

6.2 start inv_<id> (B –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è)

–û—Ç–≤–µ—Ç B:

¬´–í—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –º–∞—Ç—á—É —Å <@A>. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ñ–ª–æ—Ç: –∞–≤—Ç–æ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é (—Å–º. —Ñ–æ—Ä–º–∞—Ç –≤—ã—à–µ).¬ª

–û—Ç–≤–µ—Ç –ê:

¬´–ò–≥—Ä–æ–∫ B –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ñ–ª–æ—Ç: –∞–≤—Ç–æ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é.¬ª

6.3 –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

–ü–æ—Å–ª–µ –≤–∞–ª–∏–¥–Ω–æ–π —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏: ¬´–§–ª–æ—Ç –ø—Ä–∏–Ω—è—Ç ‚úÖ. –û–∂–∏–¥–∞–µ–º —Å–æ–ø–µ—Ä–Ω–∏–∫–∞.¬ª

–ö–æ–≥–¥–∞ –æ–±–∞ –≥–æ—Ç–æ–≤—ã: ¬´–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –ü–µ—Ä–≤—ã–º–∏ —Ö–æ–¥—è—Ç: A/B.¬ª

–í—ã–≤–æ–¥–∏–º –æ–±–∞ –ø–æ–ª—è –∫–∞–∂–¥–æ–º—É –∏–≥—Ä–æ–∫—É: —Å–≤–æ—ë –∏ ¬´–ø–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞¬ª.

6.4 –•–æ–¥—ã

–ü–æ–¥—Å–∫–∞–∑–∫–∞: ¬´–í–∞—à —Ö–æ–¥. –í–≤–µ–¥–∏—Ç–µ –∫–ª–µ—Ç–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä: –¥10¬ª.

–ù–∞ –∫–∞–∂–¥—ã–π —Ö–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ—Ä–æ—Ç–∫–∏–π —Ñ–∏–¥–±–µ–∫: –ú–∏–º–æ, –†–∞–Ω–∏–ª, –£–±–∏–ª + –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –ø–æ–ª—è.

–ü—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ —Ö–æ–¥–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ): ¬´–í—Ä–µ–º—è –≤—ã—à–ª–æ, —Ö–æ–¥ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç —Å–æ–ø–µ—Ä–Ω–∏–∫—É.¬ª

6.5 –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ

¬´–ü–æ–±–µ–¥–∞ <@user>! –í—Å–µ –∫–æ—Ä–∞–±–ª–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã.¬ª

–ö–Ω–æ–ø–∫–∞/—Ñ—Ä–∞–∑–∞ ¬´—Ä–µ–≤–∞–Ω—à¬ª ‚Üí —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –º–∞—Ç—á —Ç–µ–º –∂–µ —Å–æ—Å—Ç–∞–≤–æ–º.

7) PTB v20: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
7.1 –ö–∞—Ä–∫–∞—Å (Polling/Webhook ‚Äî –Ω–∞ –≤–∞—à–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ)

Application.builder().token(TOKEN).build()

Handlers:

CommandHandler("newgame", newgame)

CommandHandler("start", start) ‚Äî –ª–æ–≤–∏–º inv_<id>

MessageHandler(filters.TEXT & ~filters.COMMAND, router_text) ‚Äî –æ–±—â–∏–π —Ä–æ—É—Ç–µ—Ä —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –≤—Ö–æ–¥–æ–≤ –ø–æ —Ç–µ–∫—É—â–µ–º—É status/–ø–æ–¥—Ñ–∞–∑–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: /cancel, /help.

7.2 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–í —Ç–∞–±–ª–∏—Ü–µ ¬´users¬ª –¥–µ—Ä–∂–∏—Ç–µ current_match_id, phase: placing|playing|idle –∏ ¬´–æ–∂–∏–¥–∞–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ¬ª:

awaiting_fleet ‚Äî –∂–¥—ë–º –≤–≤–æ–¥ —Ñ–ª–æ—Ç–∞/–∞–≤—Ç–æ.

awaiting_shot ‚Äî –∂–¥—ë–º –≤—ã—Å—Ç—Ä–µ–ª.

router_text(update):

–ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –µ–≥–æ current_match_id ‚Üí –º–∞—Ç—á.

–ï—Å–ª–∏ placing –∏ awaiting_fleet: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∞–≤—Ç–æ/–≤–≤–æ–¥; –µ—Å–ª–∏ –û–ö ‚Üí ready=true, –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ç–æ—Ä–æ–≥–æ.

–ï—Å–ª–∏ playing –∏ —ç—Ç–æ –µ–≥–æ –æ—á–µ—Ä–µ–¥—å: –ø–∞—Ä—Å–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É, –ø—Ä–∏–º–µ–Ω—è–µ–º –≤—ã—Å—Ç—Ä–µ–ª, —Ä–µ–Ω–¥–µ—Ä–∏–º, —É–≤–µ–¥–æ–º–ª—è–µ–º –æ–±–æ–∏—Ö, –æ–±–Ω–æ–≤–ª—è–µ–º turn/–ø–æ–±–µ–¥–∏—Ç–µ–ª—è.

7.3 –¢–∞–π–º–µ—Ä—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)

application.job_queue.run_once(timeout_job, when=turn_deadline, data=match_id)

–í timeout_job: –µ—Å–ª–∏ —Ö–æ–¥ –Ω–µ —Å–¥–µ–ª–∞–Ω ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ–º miss/–ø–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞.

8) –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ —Ñ–ª–æ—Ç–∞ –≤—Ä—É—á–Ω—É—é

–ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç: –æ—Ç—Ä–µ–∑–∫–∏ (–±—É–∫–≤–∞–ª—å–Ω–æ 10 —à—Ç—É–∫):

4: –∞1-–∞4

3: –≥7-–µ7

‚Ä¶
–ü—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:

–°–ø–ª–∏—Ç –ø–æ ¬´;¬ª.

–î–ª—è –∫–∞–∂–¥–æ–≥–æ ‚Äî –¥–ª–∏–Ω–∞ + –¥–≤–∞ –∫–æ–Ω—Ü–∞ –æ—Ç—Ä–µ–∑–∫–∞ (start_cell, end_cell).

–ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã start<=end.

–í—ã—á–∏—Å–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–ª–µ—Ç–æ–∫ –æ—Ç—Ä–µ–∑–∫–∞ (–ø–æ r –∏–ª–∏ –ø–æ c).

–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É, –≥—Ä–∞–Ω–∏—Ü—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–∞—Å–∞–Ω–∏–π/–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π.

–í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ ‚Äî –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π.

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: ¬´–ø–æ—Å–µ–∫—Ü–∏–æ–Ω–Ω—ã–π¬ª –≤–≤–æ–¥ (—Å–Ω–∞—á–∞–ª–∞ –≤—Å–µ ¬´4¬ª, –ø–æ—Ç–æ–º ¬´3¬ª, ‚Ä¶), –Ω–æ —ç—Ç–æ –¥–æ–ª—å—à–µ.

9) –†–µ–Ω–¥–µ—Ä–µ—Ä –¥–æ—Å–∫–∏

–§—É–Ω–∫—Ü–∏—è render_board_own(board) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É <pre>...</pre>.

–§—É–Ω–∫—Ü–∏—è render_board_enemy(enemy_board) ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–æ–¥—ã 2/3/4/5 –≤ x/‚ñ†/‚ñì/x, –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî ¬∑.

–û–±—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫: –æ—Å—å X ‚Äî –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ (–∞–±–≤–≥–¥–µ–∂–∑–∏–∫); –æ—Å—å Y ‚Äî —á–∏—Å–ª–∞ 1‚Ä¶10.

–°–ª–µ–¥–∏—Ç–µ, —á—Ç–æ–±—ã —à–∏—Ä–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ —É–∫–ª–∞–¥—ã–≤–∞–ª–∞—Å—å (~30‚Äì35 —Å–∏–º–≤–æ–ª–æ–≤). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω–æ—á–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã.

10) –ê–Ω—Ç–∏—á–∏—Ç –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

–õ—é–±–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤–µ—Ä—è–π—Ç–µ —Å –º–∞—Ç—á–µ–º:

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫?

–°–µ–π—á–∞—Å –µ–≥–æ –æ—á–µ—Ä–µ–¥—å (–≤ —Ñ–∞–∑–µ –±–æ—è)?

–ö–ª–µ—Ç–∫–∞ —Ä–∞–Ω–µ–µ –Ω–µ —Å—Ç—Ä–µ–ª—è–Ω–∞?

–í —Ñ–∞–∑–µ placing ‚Äî –µ—â–µ –Ω–µ—Ç ready.

–ù–∞ –∫–∞–∂–¥–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–≤–µ—á–∞–π—Ç–µ —á—ë—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º, –ø—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ–º, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ —Ç–∞–∫.

–î–µ–¥—É–ø –∫–ª–∏–∫–æ–≤ –Ω–µ –Ω—É–∂–µ–Ω (–∫–Ω–æ–ø–æ–∫ –Ω–µ—Ç), –Ω–æ –ø–æ–≤—Ç–æ—Ä—ã —Ç–µ–∫—Å—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ ¬´–¥–≤–æ–π–Ω—ã–µ¬ª —Ö–æ–¥—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º turn_counter.

11) –¢–æ–Ω–∫–æ—Å—Ç–∏ ¬´—É–±–∏–ª¬ª (–∫–æ–Ω—Ç—É—Ä)

–ü–æ—Å–ª–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏—è –∫–æ—Ä–∞–±–ª—è ¬´—É–±–∏—Ç—ã–º¬ª:

–í—Å–µ –µ–≥–æ –ø–∞–ª—É–±—ã ‚Üí 4.

–í—Å–µ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏ (8 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ—Ç –∫–∞–∂–¥–æ–π –ø–∞–ª—É–±—ã), –µ—Å–ª–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö:

–ï—Å–ª–∏ —Ç–∞–º 0 ‚Üí 5 (–∑–∞–ø—Ä–µ—Ç–Ω–∞—è, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç ¬´–º–∏–º–æ¬ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ø–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ –∫–∞–∫ x).

–ï—Å–ª–∏ —É–∂–µ 2/3/4/5 ‚Äî –æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å.

–≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç UX: –∏–≥—Ä–æ–∫ –≤–∏–¥–∏—Ç ¬´–∑–∞—á—ë—Ä–∫–Ω—É—Ç—É—é¬ª –∑–æ–Ω—É –≤–æ–∫—Ä—É–≥ —É–±–∏—Ç–æ–≥–æ.

12) –°–æ–æ–±—â–µ–Ω–∏—è‚Äë—à–∞–±–ª–æ–Ω—ã (—Å–æ–≤–º–µ—â–∞–µ–º –ø–æ–ª—è –∏ —Å—Ç–∞—Ç—É—Å)

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–∏–º–æ–≥–æ —à–∞–≥–∞ —à–ª–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫—É—é —Å–≤–æ–¥–∫—É + –¥–≤–µ –¥–æ—Å–∫–∏:

–ò–≥—Ä–æ–∫—É A:

¬´–í–∞—à–µ –ø–æ–ª–µ:¬ª

<pre>...own A...</pre>

¬´–ü–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞:¬ª

<pre>...enemy B...</pre>

¬´–†–µ–∑—É–ª—å—Ç–∞—Ç —Ö–æ–¥–∞: –†–∞–Ω–∏–ª / –£–±–∏–ª / –ú–∏–º–æ¬ª

¬´–¢–µ–ø–µ—Ä—å —Ö–æ–¥–∏—Ç: –í—ã / –°–æ–ø–µ—Ä–Ω–∏–∫¬ª

–ò–≥—Ä–æ–∫—É B ‚Äî —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ.

13) –ú–∏–Ω–∏‚Äë—Å–∫–µ–ª–µ—Ç –º–æ–¥—É–ª–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ)
project/
  app.py                   # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ PTB
  storage.py               # CRUD –º–∞—Ç—á–µ–π/—é–∑–µ—Ä–æ–≤
  models.py                # –¥–∞—Ç–∞–∫–ª–∞—Å—Å—ã (Match, Board, Ship)
  logic/
    parser.py              # –ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç/–æ—Ç—Ä–µ–∑–∫–æ–≤
    placement.py           # –≤–∞–ª–∏–¥–∞—Ü–∏—è/–∞–≤—Ç–æ–≥–µ–Ω –∫–æ—Ä–∞–±–ª–µ–π
    battle.py              # –≤—ã—Å—Ç—Ä–µ–ª, hit/kill/–∫–æ–Ω—Ç—É—Ä, –ø–æ–±–µ–¥–∞
    render.py              # —Ä–µ–Ω–¥–µ—Ä <pre> –¥–æ—Å–æ–∫
  handlers/
    commands.py            # /start /newgame /help
    router.py              # —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–æ—É—Ç–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π
    jobs.py                # —Ç–∞–π–º–µ—Ä—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)

14) –¢–µ—Å—Ç‚Äë—á–µ–∫–ª–∏—Å—Ç

–ü–∞—Ä—Å–µ—Ä –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç: –¥10, –≥7, –ø—Ä–æ–±–µ–ª—ã, —Ä–µ–≥–∏—Å—Ç—Ä, –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –±—É–∫–≤—ã/—á–∏—Å–ª–∞.

–†–∞–∑–º–µ—â–µ–Ω–∏–µ: –≤—Å–µ —Ç–∏–ø—ã –∫–æ—Ä–∞–±–ª–µ–π; –∑–∞–ø—Ä–µ—Ç –∫–∞—Å–∞–Ω–∏–π; –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∫–ª–µ—Ç–∫–∏; —Ä—É—á–Ω–æ–π –∏ –∞–≤—Ç–æ.

–•–æ–¥—ã: –º–∏–º–æ ‚Üí —Å–º–µ–Ω–∞ —Ö–æ–¥–∞; —Ä–∞–Ω–∏–ª/—É–±–∏–ª ‚Üí –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ö–æ–¥; –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø–∞–¥–∞–Ω–∏–π –ø–æ–¥—Ä—è–¥; –∞–≤—Ç–æ–∫–æ–Ω—Ç—É—Ä.

–û–∫–æ–Ω—á–∞–Ω–∏–µ: –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ø–∞–¥–∞–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–∞—Ç—á; —Ä–µ–≤–∞–Ω—à —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π.

–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –±—ã—Å—Ç—Ä—ã–µ ¬´–¥–≤–æ–π–Ω—ã–µ¬ª —Ö–æ–¥—ã, –≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å).

–†–µ–Ω–¥–µ—Ä: —à–∏—Ä–∏–Ω–∞ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ emoji, parse_mode=HTML.

15) –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

–°–ª—É—á–∞–π–Ω—ã–µ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –≤ –ø–æ–ª–µ ‚Üí –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ —Å—Ç—Ä–æ–∫–∞ –∫–æ—Ä–æ—á–µ ~35 —Å–∏–º–≤–æ–ª–æ–≤.

–°–º–µ—à–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–æ–∫ ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑—É–π—Ç–µ –≤–≤–æ–¥ (–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤, –º–∞–ø–ø–∏–Ω–≥ –ª–∞—Ç–∏–Ω–∏—Ü—ã‚Üí–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏).

–ì–æ–Ω–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π ‚Üí —Å–Ω–∞—á–∞–ª–∞ –∞—Ç–æ–º–∞—Ä–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∫ –ë–î, –ø–æ—Ç–æ–º —à–ª–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±–æ–∏–º.

–£—Ç–µ—á–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Üí –Ω–∞ ¬´–ø–æ–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞¬ª –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–µ–Ω–¥–µ—Ä—å—Ç–µ –∂–∏–≤—ã–µ –ø–∞–ª—É–±—ã.

16) –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ PTB (v20+)

MessageHandler(filters.TEXT & ~filters.COMMAND, router_text) ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è ¬´–∞–≤—Ç–æ¬ª, —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –≤—ã—Å—Ç—Ä–µ–ª–æ–≤.

–î–ª—è deep‚Äëlink: –≤ start(update, context) —Å–º–æ—Ç—Ä–∏—Ç–µ update.message.text ‚Üí split() ‚Üí –∏—â–∏—Ç–µ inv_<id>.

–ß—Ç–æ–±—ã ¬´–¥–µ—Ä–∂–∞—Ç—å —Ö–æ–¥¬ª: –ø–æ–ª–µ turn ('A'|'B') + last_result.

–í –æ—Ç–≤–µ—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ (–∫–∞–∂–¥–æ–º—É –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç) –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ ¬´–≥–ª–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ¬ª (–µ—Å–ª–∏ —Ç–∞–∫ —Ä–µ—à–∏–ª–∏).

17) –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –æ—à–∏–±–æ–∫ (–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π)

¬´–ù–µ –ø–æ–Ω—è–ª –∫–ª–µ—Ç–∫—É. –ü—Ä–∏–º–µ—Ä: –µ5 –∏–ª–∏ –¥10. –î–æ–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–æ–±–µ–ª—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä –Ω–µ–≤–∞–∂–µ–Ω.¬ª

¬´–†–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ: –∫–æ—Ä–∞–±–ª—å 3 –ø–∞–ª—É–±—ã –≥7-–µ7 ‚Äî –¥–∏–∞–≥–æ–Ω–∞–ª—å –∑–∞–ø—Ä–µ—â–µ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥7-–≥9 –∏–ª–∏ –µ5-–≥5.¬ª

18) –ß—Ç–æ –º–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –Ω–∞ —Å—Ç–∞—Ä—Ç–µ

–¢–æ–ª—å–∫–æ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–ª–æ—Ç–∞: —É–±–∏—Ä–∞–µ—Ç —Ü–µ–ª—ã–π –ø–ª–∞—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç—Ä–µ–∑–∫–æ–≤.

–ë–µ–∑ —Ç–∞–π–º–µ—Ä–æ–≤: –¥–æ–±–∞–≤–∏—Ç–µ –ø–æ–∑–∂–µ.


19) –†–µ–∂–∏–º ¬´–¢–µ—Å—Ç 2 –∏–≥—Ä–æ–∫–æ–≤¬ª

–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: –∫–Ω–æ–ø–∫—É –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞ –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ ADMIN_ID, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –µ—ë –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –Ω–∏ –≤ –æ–¥–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏.

–°—Ü–µ–Ω–∞—Ä–∏–π: –ø–æ –Ω–∞–∂–∞—Ç–∏—é –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π –º–∞—Ç—á, –≥–¥–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–Ω–∏–º–∞–µ—Ç —Ä–æ–ª—å –∏–≥—Ä–æ–∫–∞ A, –∞ —Ä–æ–ª—å –∏–≥—Ä–æ–∫–∞ B –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç. –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –ø—Ä–∏–≤–∞—Ç–Ω—É—é –¥—É—ç–ª—å –±–µ–∑ —à–∞–≥–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è: –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–µ –∂–µ —Å—Ç–∞–¥–∏–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∏ –±–æ—è, —á—Ç–æ –∏ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏. –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —à–∞–±–ª–æ–Ω—ã, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ö–æ–¥–µ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –≤—ã—Å—Ç—Ä–µ–ª–æ–≤ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –º–∞—Ç—á–∞ –æ—Å—Ç–∞—é—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º–∏ –æ–±—ã—á–Ω–æ–π –∏–≥—Ä–µ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–ª–æ—É ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª.

–ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –±–æ—Ç–∞: –æ–Ω —Å—Ä–∞–∑—É —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ—Ä–∞–±–ª–∏ (–º–æ–∂–Ω–æ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞), —Å—Ç—Ä–µ–ª—è–µ—Ç –ø–æ —Å–ª—É—á–∞–π–Ω—ã–º –Ω–µ–∑–∞–Ω—è—Ç—ã–º –∫–ª–µ—Ç–∫–∞–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç—É –∂–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–π/—É–±–∏–π—Å—Ç–≤, —á—Ç–æ –∏ –¥–ª—è –∂–∏–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤. –ú–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –±–æ—Ç–∞ –¥–æ–±–∞–≤—å—Ç–µ –Ω–µ–±–æ–ª—å—à—É—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É (1‚Äì2 —Å–µ–∫—É–Ω–¥—ã), —á—Ç–æ–±—ã –ø–µ—Ä–µ–ø–∏—Å–∫–∞ –≤—ã–≥–ª—è–¥–µ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –Ω–µ –ª–æ–º–∞–ª–∞ –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π.